"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[454],{9758:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>l,contentTitle:()=>i,default:()=>u,frontMatter:()=>a,metadata:()=>o,toc:()=>d});var r=n(5893),t=n(1151);const a={sidebar_position:7},i=void 0,o={id:"Systemes/Mysql & Mariadb",title:"Mysql & Mariadb",description:"Installation du Serveur MariaDB",source:"@site/docs/Systemes/Mysql & Mariadb.md",sourceDirName:"Systemes",slug:"/Systemes/Mysql & Mariadb",permalink:"/DevopsExplorerDemo/docs/Systemes/Mysql & Mariadb",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:7,frontMatter:{sidebar_position:7},sidebar:"tutorialSidebar",previous:{title:"Nginx",permalink:"/DevopsExplorerDemo/docs/Systemes/Nginx"},next:{title:"Redis et Memcashed",permalink:"/DevopsExplorerDemo/docs/Systemes/Redis et Memcashed"}},l={},d=[{value:"Installation du Serveur MariaDB",id:"installation-du-serveur-mariadb",level:3},{value:"Percona-Toolkit Installation",id:"percona-toolkit-installation",level:3},{value:"Mysql socket &amp; reseau",id:"mysql-socket--reseau",level:3},{value:"Cr\xe9ation du user et database",id:"cr\xe9ation-du-user-et-database",level:3},{value:"Sauvegarder Les Databases",id:"sauvegarder-les-databases",level:3}];function c(e){const s={a:"a",blockquote:"blockquote",br:"br",code:"code",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.h3,{id:"installation-du-serveur-mariadb",children:"Installation du Serveur MariaDB"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.code,{children:"sudo apt install mariadb-server"})}),"\n",(0,r.jsx)(s.p,{children:"Par d\xe9faut, le mot de passe administrateur MySQL/MariaDB sera le m\xeame que celui de votre utilisateur syst\xe8me. Pour personnaliser la s\xe9curisation de notre base de donn\xe9es, voici la commande \xe0 ex\xe9cuter :"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.code,{children:"mysql_secure_installation"})}),"\n",(0,r.jsxs)(s.blockquote,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Change the root password [Y/n] =>"})," y // changez le mot de passe",(0,r.jsx)(s.br,{}),"\n",(0,r.jsx)(s.strong,{children:"New password"})," // Entrez votre mot de passe \xab root \xbb",(0,r.jsx)(s.br,{}),"\n",(0,r.jsx)(s.strong,{children:"Remove anonymous users [Y/n] =>"})," y // D\xe9sactivez ensuite les connexions anonymes",(0,r.jsx)(s.br,{}),"\n",(0,r.jsx)(s.strong,{children:"Disallow root login remotely?"})," [Y/n] => y // D\xe9sactivez la connexion en \xab root \xbb depuis une connexion distante",(0,r.jsx)(s.br,{}),"\n",(0,r.jsx)(s.strong,{children:"Remove test database and access to it?"})," [Y/n] => y // effacer la base de donn\xe9es de test cr\xe9\xe9e par d\xe9faut",(0,r.jsx)(s.br,{}),"\n",(0,r.jsx)(s.strong,{children:"Reload privilege tables now? [Y/n] =>"})," y // Il reste \xe0 charger les nouveaux param\xe8tres"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:"Pour tester l'acc\xe8s \xe0 notre base de donn\xe9es, voici la commande \xe0 utiliser dans notre terminal :"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"mysql -u root \u2013p\r\nshow databases\r\nexit\n"})}),"\n",(0,r.jsx)(s.h3,{id:"percona-toolkit-installation",children:"Percona-Toolkit Installation"}),"\n",(0,r.jsx)(s.p,{children:"Percona Toolkit, largement utilis\xe9 dans les environnements MySQL et Percona Server, est une collection d'outils qui aide les administrateurs de bases de donn\xe9es \xe0 g\xe9rer leurs t\xe2ches quotidiennes. Ces outils offrent aux utilisateurs flexibilit\xe9 et contr\xf4le en mati\xe8re de performances, de fiabilit\xe9 et de maintenance."}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.code,{children:"sudo apt install percona-toolkit"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.code,{children:"pt-show-grants"})}),"\n",(0,r.jsxs)(s.p,{children:["Copier la ligne ",(0,r.jsx)(s.strong,{children:"mysql"})," et accordez les autorisations \xe0 l'utilisateur student."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"GRANT ALL PRIVILEGES ON *.* TO `student`@`localhost` IDENTIFIED VIA mysql_native_password USING 'invalid' OR unix_socket WITH GRANT OPTION;\n"})}),"\n",(0,r.jsx)(s.p,{children:"D\xe9sormais, student peut se connecter directement \xe0 MySQL sans avoir besoin d'\xeatre root.**"}),"\n",(0,r.jsx)(s.h3,{id:"mysql-socket--reseau",children:"Mysql socket & reseau"}),"\n",(0,r.jsx)(s.p,{children:"Note : Vous pouvez basculer vers l'utilisateur MySQL en utilisant la commande suivante :"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"su \u2013 mysql -s /bin/bash\n"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.code,{children:"mysql"})," : Se connecte directement en utilisant le socket.",(0,r.jsx)(s.br,{}),"\n",(0,r.jsx)(s.code,{children:"mysql -h localhost"})," : Se connecte via le r\xe9seau."]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"mysql -u test -p\t\t# Se connecter avec le nom d'utilisateur test, entrer le mot de passe (socket)\r\nmysql -u test -h localhost -p \t# Se connecter avec le nom d'utilisateur test, entrer le mot de passe (r\xe9seau)\n"})}),"\n",(0,r.jsx)(s.h3,{id:"cr\xe9ation-du-user-et-database",children:"Cr\xe9ation du user et database"}),"\n",(0,r.jsx)(s.p,{children:'Nous avons cr\xe9\xe9 un utilisateur nomm\xe9 "Incubator" et avons \xe9galement cr\xe9\xe9 une base de donn\xe9es nomm\xe9e "incubator". Ensuite, nous avons accord\xe9 \xe0 l\'utilisateur "incubator" tous les privil\xe8ges dans la base de donn\xe9es "incubator".'}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"CREATE USER 'incubator'@'localhost' IDENTIFIED BY 'password';\r\nCREATE DATABASE incubator;\r\nGRANT ALL PRIVILEGES ON incubator.* TO 'incubator'@'localhost';\n"})}),"\n",(0,r.jsx)(s.h3,{id:"sauvegarder-les-databases",children:"Sauvegarder Les Databases"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"mysqldump pingpong > dump.sql  #Pour sauvegarder\r\nmysql < dump.sql\t# Pour restaurer\n"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"sftp student@fdfkdfdf.\r\n\tget dump.sql\t# T\xe9l\xe9chargez ce fichier via SSH\n"})}),"\n",(0,r.jsx)(s.p,{children:"Nous pouvons automatiser le processus de sauvegarde des donn\xe9es MySQL avec un script simple de trois mani\xe8res :"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"/DevopsExplorerDemo/docs/Systemes/Systemd%20Services",children:"Utilisation de Systemd/Service"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"/DevopsExplorerDemo/docs/Systemes/Github%20Action%20Runner",children:"Utilisation de GitHub Action runner"})}),"\n",(0,r.jsx)(s.li,{children:"Utilisation de crontab"}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"Exemple de fichier backup.sh :"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:'#!/bin/bash\r\n\r\n# Sp\xe9cifiez les informations de connexion \xe0 la base de donn\xe9es\r\nDB_NAME="pingpong"\r\n\r\n# Sp\xe9cifiez le r\xe9pertoire de sauvegarde\r\nBACKUP_DIR="/home/student/backup"\r\nTIMESTAMP=$(date +"%Y%m%d%H%M%S")\r\nBACKUP_FILE="$BACKUP_DIR/$DB_NAME-$TIMESTAMP.sql.gz"\r\n\r\n# Commande pour effectuer la sauvegarde et la compression\r\nmysqldump -A | gzip > $BACKUP_FILE\r\n\r\n# Supprimer les sauvegardes de plus de 10 jours\r\nfind -name \'*.sql.gz\' -mtime +10 -delete-\r\n\r\n# V\xe9rifiez si la sauvegarde et la compression ont r\xe9ussi\r\nif [ $? -eq 0 ]; then\r\n  echo "Sauvegarde de toutes les bases de donn\xe9es effectu\xe9e avec succ\xe8s dans $BACKUP_FILE"\r\nelse\r\n  echo "\xc9chec de la sauvegarde et de la compression"\r\n  exit 1\r\nfi\n'})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Ajouter une t\xe2che cron.",(0,r.jsx)(s.br,{}),"\n","S'ex\xe9cute toutes les heures",(0,r.jsx)(s.br,{}),"\n",(0,r.jsx)(s.code,{children:"0 * * * * /chemin/vers/votre/backup.sh"})]}),"\n"]})]})}function u(e={}){const{wrapper:s}={...(0,t.a)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},1151:(e,s,n)=>{n.d(s,{Z:()=>o,a:()=>i});var r=n(7294);const t={},a=r.createContext(t);function i(e){const s=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),r.createElement(a.Provider,{value:s},e.children)}}}]);